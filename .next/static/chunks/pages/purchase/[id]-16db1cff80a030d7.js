(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[612],{3248:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/purchase/[id]",function(){return n(7812)}])},5437:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(4051),a=n.n(r),o=n(5893),s=n(9669),i=n.n(s),c=n(9755),l=n.n(c),u=n(7294);function d(e,t,n,r,a,o,s){try{var i=e[o](s),c=i.value}catch(l){return void n(l)}i.done?t(c):Promise.resolve(c).then(r,a)}function h(e){var t=e.name,n=e.id,r=e.token,s={headers:{Authorization:"Bearer ".concat(r)}},c=(0,u.useState)(null),h=c[0],p=c[1],m=(0,u.useState)(),f=m[0],x=m[1],b=function(){var e,t=(e=a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l()(".autocompleteItemContainer.supplier").show(),h&&(clearTimeout(h),p(null)),t=l()(".autocompleteInput").val(),p(setTimeout((function(){i().get("".concat("//pos-backend.webxcode.xyz/api","/supplier?name=").concat(t),s).then((function(e){!0===e.data.status&&x(e.data.suppliers.data)})).catch((function(e){console.log(e)}))}),1e3));case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){d(o,r,a,s,i,"next",e)}function i(e){d(o,r,a,s,i,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}();return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"autocompleteWrapper",children:[(0,o.jsx)("input",{type:"text",className:"form-control autocompleteInput supplier-input",autoComplete:"off",defaultValue:t,onKeyUp:b,onKeyDown:b,onChange:b}),(0,o.jsx)("input",{type:"hidden",className:"supplier-id",defaultValue:n}),(0,o.jsx)("div",{className:"autocompleteItemContainer supplier",children:f&&f.map((function(e){return(0,o.jsx)("div",{className:"autocompleteItem",onClick:function(){return t=e.name,n=e.id,l()(".supplier-input").val(t),l()(".supplier-id").val(n),void l()(".autocompleteItemContainer.supplier").hide();var t,n},children:e.name},"supplier-".concat(e.id))}))})]})})}},9270:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(5893);function a(){return(0,r.jsx)("div",{className:"loader"})}},4689:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5893),a=n(4849);function o(e){for(var t=e.td,n=e.tr,o=[],s=0;s<n;s++)o.push(s);for(var i=[],c=0;c<t;c++)i.push(c);return o.map((function(e,t){return(0,r.jsx)("tr",{children:i.map((function(e,t){return(0,r.jsx)("td",{children:(0,r.jsx)(a.y,{baseColor:"rgba(249, 58, 11, 0.1)",highlightColor:"#212130",children:(0,r.jsx)("p",{children:(0,r.jsx)(a.Z,{width:"100%",height:30})})})},t)}))},t)}))}},7812:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return C},default:function(){return k}});var r=n(4051),a=n.n(r),o=n(5893),s=n(5688),i=n(9008),c=n(5538),l=n(9669),u=n.n(l),d=n(9755),h=n.n(d),p=n(7294),m=n(9198),f=n.n(m),x=n(9270),b=n(4849),j=n(4689),v=n(5437);function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t,n,r,a,o,s){try{var i=e[o](s),c=i.value}catch(l){return void n(l)}i.done?t(c):Promise.resolve(c).then(r,a)}function N(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){y(o,r,a,s,i,"next",e)}function i(e){y(o,r,a,s,i,"throw",e)}s(void 0)}))}}function w(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var C=!0;function k(e){var t=e.user,n=e.id,r=(0,p.useState)(!1),l=r[0],d=r[1],m=(0,p.useState)(0),g=m[0],y=m[1],C=(0,p.useState)(0),k=C[0],S=C[1],P=(0,p.useState)(),_=P[0],A=P[1],I=(0,p.useState)(!0),D=I[0],E=I[1],F=(0,p.useState)(),O=F[0],Z=F[1],T=(0,p.useState)(null),K=T[0],B=T[1],U=(0,p.useState)(new Date),V=U[0],z=U[1],Q=(0,p.useState)([]),H=Q[0],$=Q[1],M={headers:{Authorization:"Bearer ".concat(t.token)}};(0,p.useEffect)((function(){u().get("".concat("//pos-backend.webxcode.xyz/api","/purchase/").concat(n),M).then((function(e){!0===e.data.status&&(A(e.data.purchase),y(e.data.purchase.purchaseData.amount),z(new Date(e.data.purchase.purchaseData.date)),S(e.data.purchase.purchaseData.paid),$(e.data.purchase.purchaseItems),E(!1))})).catch((function(e){console.log(e)}))}),[A,y,z,S,$,E]);var R=function(){var e=N(a().mark((function e(t){var r,o,s,i,l,p,m,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c.Am.loading("Submitting",{position:"bottom-right",theme:"dark"}),d(!0),r=h()(".productId").map((function(e,t){return h()(t).val()})).get(),o=h()(".productQuantity").map((function(e,t){return h()(t).val()})).get(),s=h()(".productPrice").map((function(e,t){return h()(t).val()})).get(),i=h()(".note").val(),l=h()(".date").val(),p=h()(".paid").val(),""!==(m=h()(".supplier-id").val())){e.next=15;break}return d(!1),c.Am.dismiss(),c.Am.error("Please select supplier",{position:"bottom-right",autoClose:!1,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"dark"}),e.abrupt("return");case 15:if(!(r.length<=0)){e.next=20;break}return d(!1),c.Am.dismiss(),c.Am.error("No product added",{position:"bottom-right",autoClose:!1,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"dark"}),e.abrupt("return");case 20:return e.prev=20,e.next=23,u().post("".concat("//pos-backend.webxcode.xyz/api","/purchase/update"),{purchase_id:n,supplier_id:m,productIds:r,productQuantities:o,productPrices:s,date:l,comment:i,paid:p,total:g},M);case 23:!0===(f=e.sent).data.status?(c.Am.dismiss(),c.Am.success("Successfully Saved",{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"dark"}),d(!1)):(c.Am.dismiss(),c.Am.success(f.data.error,{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"dark"}),d(!1)),e.next=32;break;case 27:e.prev=27,e.t0=e.catch(20),c.Am.dismiss(),c.Am.error(e.t0.response.data,{position:"bottom-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"dark"}),d(!1);case 32:case"end":return e.stop()}}),e,null,[[20,27]])})));return function(t){return e.apply(this,arguments)}}(),q=function(e){var t=parseFloat(h()(".productPrice_".concat(e)).val())*parseFloat(h()(".productQuantity_".concat(e)).val());h()(".subtotal_".concat(e)).text("".concat(t)),W()},W=function(){y(0),h()(".subtotal").each((function(){var e=this;y((function(t){return t+parseFloat(h()(e).text())}))}))},X=function(){var e=h()(".paid").val();S(""!==e?parseFloat(e):0)},L=function(){var e=N(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h()(".autocompleteItemContainer.product").show(),K&&(clearTimeout(K),B(null)),t=h()(".search-product").val(),B(setTimeout((function(){u().get("".concat("//pos-backend.webxcode.xyz/api","/product?name=").concat(t),M).then((function(e){!0===e.data.status&&Z(e.data.products.data)})).catch((function(e){console.log(e)}))}),500));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.default,{children:(0,o.jsx)("title",{children:"Edit Purchase"})}),l&&!0===l&&(0,o.jsx)(x.Z,{}),(0,o.jsx)(c.Ix,{}),(0,o.jsx)(s.Z,{user:t,title:"Edit Purchase",children:(0,o.jsx)("div",{className:"content",children:(0,o.jsx)("div",{className:"custom-card",children:(0,o.jsxs)("form",{onSubmit:R,children:[(0,o.jsx)("div",{className:"mb-3",children:(0,o.jsxs)("div",{className:"row",children:[(0,o.jsxs)("div",{className:"col-md-6",children:[(0,o.jsx)("label",{htmlFor:"supplier",className:"form-label",children:"Supplier"}),_&&!1===D&&(0,o.jsx)(v.Z,{name:_.purchaseData.supplier_name,id:_.purchaseData.supplier_id,token:t.token})||(0,o.jsx)(b.y,{baseColor:"rgba(249, 58, 11, 0.1)",highlightColor:"#212130",children:(0,o.jsx)(b.Z,{width:"100%",height:40})})]}),(0,o.jsxs)("div",{className:"col-md-6",children:[(0,o.jsx)("label",{htmlFor:"date",className:"form-label",children:"Date"}),_&&!1===D&&(0,o.jsx)(f(),{selected:V,onChange:function(e){return z(e)},dateFormat:"yyyy-MM-dd",className:"form-control date"})||(0,o.jsx)(b.y,{baseColor:"rgba(249, 58, 11, 0.1)",highlightColor:"#212130",children:(0,o.jsx)(b.Z,{width:"100%",height:40})})]})]})}),(0,o.jsxs)("div",{className:"mb-3",children:[(0,o.jsx)("label",{htmlFor:"product",className:"form-label",children:"Choose Product"}),(0,o.jsxs)("div",{className:"autocompleteWrapper product",children:[(0,o.jsx)("input",{type:"text",className:"form-control autocompleteInput search-product",autoComplete:"off",onKeyUp:L,onKeyDown:L,onChange:L,placeholder:"Search product"}),(0,o.jsx)("div",{className:"autocompleteItemContainer product",children:O&&O.map((function(e){return(0,o.jsx)("div",{className:"autocompleteItem",onClick:function(){return function(e){var t=H.filter((function(t){return t.id===e.id.toString()}));console.log(t),t.length>0?alert("Product already added"):($((function(t){return w(t).concat([e])})),y((function(t){return parseFloat(t)+parseFloat(e.price)}))),h()(".autocompleteItemContainer.product").hide(),h()(".search-product").val("")}(e)},children:e.name},"search-product-item-".concat(e.id))}))})]})]}),(0,o.jsxs)("table",{className:"table table-bordered table-hover",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{width:"5%",children:"SL"}),(0,o.jsx)("th",{width:"40%",children:"Product Name"}),(0,o.jsx)("th",{width:"15%",children:"Purchase Price"}),(0,o.jsx)("th",{width:"15%",children:"Quantity"}),(0,o.jsx)("th",{className:"text-end",width:"20%",children:"Subtotal"}),(0,o.jsx)("th",{className:"text-center",width:"5%",children:"Action"})]})}),(0,o.jsx)("tbody",{children:H&&!D&&H.map((function(e,t){return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:t+1}),(0,o.jsxs)("td",{children:[e.name,(0,o.jsx)("input",{type:"hidden",className:"productId",defaultValue:e.id})]}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"text",className:"form-control productPrice productPrice_".concat(e.id),defaultValue:e.price,onChange:function(){return q(e.id)},onKeyUp:function(){return q(e.id)},onKeyDown:function(){return q(e.id)}})}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"text",className:"form-control productQuantity productQuantity_".concat(e.id),defaultValue:e.quantity?e.quantity:1,onChange:function(){return q(e.id)},onKeyUp:function(){return q(e.id)},onKeyDown:function(){return q(e.id)}})}),(0,o.jsxs)("td",{className:"text-end",children:[(0,o.jsx)("span",{className:"subtotal subtotal_".concat(e.id),children:e.total?e.total:e.price})," Tk."]}),(0,o.jsx)("td",{className:"text-center",children:(0,o.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){return function(e){var t=H.filter((function(t){return t.id!==e}));$(t),y(0),t.map((function(e){y((function(t){return t+parseFloat(h()(".subtotal_".concat(e.id)).text())}))}))}(e.id)},children:(0,o.jsx)("i",{className:"fa-solid fa-trash-can"})})})]},"purchase-product-item-".concat(e.id))}))||(0,o.jsx)(j.Z,{tr:5,td:6})}),(0,o.jsxs)("tfoot",{children:[(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"text-end",colSpan:4,children:(0,o.jsx)("strong",{children:"Total"})}),(0,o.jsx)("td",{className:"text-end border-1 border-white d-block",children:_&&!1===D&&(0,o.jsxs)("span",{className:"total",children:[g," Tk."]})||(0,o.jsx)(b.y,{baseColor:"rgba(249, 58, 11, 0.1)",highlightColor:"#212130",children:(0,o.jsx)(b.Z,{width:"100%",height:30})})}),(0,o.jsx)("td",{})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"text-end",colSpan:4,children:(0,o.jsx)("strong",{children:"Paid"})}),(0,o.jsx)("td",{className:"px-0",children:_&&!1===D&&(0,o.jsx)("input",{type:"text",className:"form-control paid",onKeyUp:X,onKeyDown:X,onChange:X,defaultValue:_.purchaseData.paid})||(0,o.jsx)(b.y,{baseColor:"rgba(249, 58, 11, 0.1)",highlightColor:"#212130",children:(0,o.jsx)(b.Z,{width:"100%",height:30})})})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"text-end",colSpan:4,children:(0,o.jsx)("strong",{children:"Due"})}),(0,o.jsx)("td",{className:"text-end border-1 border-white d-block",children:_&&!1===D&&(0,o.jsxs)("span",{className:"due",children:[g-k," Tk."]})||(0,o.jsx)(b.y,{baseColor:"rgba(249, 58, 11, 0.1)",highlightColor:"#212130",children:(0,o.jsx)(b.Z,{width:"100%",height:30})})})]})]})]}),(0,o.jsxs)("div",{className:"mb-3 mt-3",children:[(0,o.jsx)("label",{htmlFor:"note",className:"form-label",children:"Note"}),_&&!D&&(0,o.jsx)("textarea",{id:"note",rows:"3",className:"note form-control",defaultValue:_.purchaseData.comment})||(0,o.jsx)(b.y,{baseColor:"rgba(249, 58, 11, 0.1)",highlightColor:"#212130",children:(0,o.jsx)(b.Z,{width:"100%",height:80})})]}),(0,o.jsx)("button",{className:"btn btn-success",type:"submit",children:"Update"})]})})})})]})}},4849:function(e,t,n){"use strict";n.d(t,{y:function(){return i},Z:function(){return s}});var r=n(7294);const a=r.createContext({});function o({baseColor:e,highlightColor:t,width:n,height:r,borderRadius:a,circle:o,direction:s,duration:i,enableAnimation:c=true}){const l={};return"rtl"===s&&(l["--animation-direction"]="reverse"),"number"===typeof i&&(l["--animation-duration"]=`${i}s`),c||(l["--pseudo-element-display"]="none"),"string"!==typeof n&&"number"!==typeof n||(l.width=n),"string"!==typeof r&&"number"!==typeof r||(l.height=r),"string"!==typeof a&&"number"!==typeof a||(l.borderRadius=a),o&&(l.borderRadius="50%"),"undefined"!==typeof e&&(l["--base-color"]=e),"undefined"!==typeof t&&(l["--highlight-color"]=t),l}function s({count:e=1,wrapper:t,className:n,containerClassName:s,containerTestId:i,circle:c=!1,style:l,...u}){var d,h,p;const m=r.useContext(a),f={...u};for(const[r,a]of Object.entries(u))"undefined"===typeof a&&delete f[r];const x={...m,...f,circle:c},b={...l,...o(x)};let j="react-loading-skeleton";n&&(j+=` ${n}`);const v=null!==(d=x.inline)&&void 0!==d&&d,g=[],y=Math.ceil(e);for(let a=0;a<y;a++){let t=b;if(y>e&&a===y-1){const n=null!==(h=t.width)&&void 0!==h?h:"100%",r=e%1,a="number"===typeof n?n*r:`calc(${n} * ${r})`;t={...t,width:a}}const n=r.createElement("span",{className:j,style:t,key:a},"\u200c");v?g.push(n):g.push(r.createElement(r.Fragment,{key:a},n,r.createElement("br",null)))}return r.createElement("span",{className:s,"data-testid":i,"aria-live":"polite","aria-busy":null===(p=x.enableAnimation)||void 0===p||p},t?g.map(((e,n)=>r.createElement(t,{key:n},e))):g)}function i({children:e,...t}){return r.createElement(a.Provider,{value:t},e)}}},function(e){e.O(0,[571,619,669,782,198,688,774,888,179],(function(){return t=3248,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
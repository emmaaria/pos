(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[653],{2020:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sale/create",function(){return n(7094)}])},8194:function(t,e,n){"use strict";n.d(e,{Z:function(){return p}});var a=n(4051),r=n.n(a),o=n(5893),c=n(9669),s=n.n(c),i=n(9755),l=n.n(i),u=n(7294);function d(t,e,n,a,r,o,c){try{var s=t[o](c),i=s.value}catch(l){return void n(l)}s.done?e(i):Promise.resolve(i).then(a,r)}function p(t){var e=t.type,n=t.token,a=t.placeholder,c={headers:{Authorization:"Bearer ".concat(n)}},i=(0,u.useState)(null),p=i[0],m=i[1],h=(0,u.useState)(),f=h[0],x=h[1],j=function(){var t,n=(t=r().mark((function t(){var n,a;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l()(".autocompleteItemContainer.supplier").show(),p&&(clearTimeout(p),m(null)),"supplier"===e&&(n=l()(".autocompleteInput").val(),m(setTimeout((function(){s().get("".concat("http://pos-backend.webxcode.xyz/api","/supplier?name=").concat(n),c).then((function(t){!0===t.data.status&&x(t.data.suppliers.data)})).catch((function(t){console.log(t)}))}),1e3))),"customer"===e&&(a=l()(".autocompleteInput").val(),m(setTimeout((function(){s().get("".concat("http://pos-backend.webxcode.xyz/api","/customer?name=").concat(a),c).then((function(t){!0===t.data.status&&x(t.data.customers.data)})).catch((function(t){console.log(t)}))}),1e3)));case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function c(t){d(o,a,r,c,s,"next",t)}function s(t){d(o,a,r,c,s,"throw",t)}c(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"autocompleteWrapper",children:[(0,o.jsx)("input",{type:"text",className:"form-control autocompleteInput supplier-input",autoComplete:"off",onKeyUp:j,onKeyDown:j,onChange:j,placeholder:a||""}),e&&"supplier"===e&&(0,o.jsx)("input",{type:"hidden",className:"supplier-id"}),e&&"customer"===e&&(0,o.jsx)("input",{type:"hidden",className:"customer-id"}),(0,o.jsx)("div",{className:"autocompleteItemContainer supplier",children:f&&f.map((function(t){return(0,o.jsx)("div",{className:"autocompleteItem",onClick:function(){return n=t.name,a=t.id,l()(".supplier-input").val(n),"supplier"===e&&l()(".supplier-id").val(a),"customer"===e&&l()(".customer-id").val(a),void l()(".autocompleteItemContainer.supplier").hide();var n,a},children:t.name},"supplier-".concat(t.id))}))})]})})}},9270:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var a=n(5893);function r(){return(0,a.jsx)("div",{className:"loader"})}},7094:function(t,e,n){"use strict";n.r(e),n.d(e,{__N_SSP:function(){return g},default:function(){return k}});var a=n(4051),r=n.n(a),o=n(5893),c=n(5688),s=n(9008),i=n(5538),l=n(9669),u=n.n(l),d=n(9755),p=n.n(d),m=n(7294),h=n(9198),f=n.n(h),x=n(8194),j=n(9270);function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function b(t,e,n,a,r,o,c){try{var s=t[o](c),i=s.value}catch(l){return void n(l)}s.done?e(i):Promise.resolve(i).then(a,r)}function N(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function c(t){b(o,a,r,c,s,"next",t)}function s(t){b(o,a,r,c,s,"throw",t)}c(void 0)}))}}function y(t){return function(t){if(Array.isArray(t))return v(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var g=!0;function k(t){var e=t.user,n=(0,m.useState)(!1),a=n[0],l=n[1],d=(0,m.useState)(0),h=d[0],v=d[1],b=(0,m.useState)(0),g=b[0],k=b[1],w=(0,m.useState)(0),C=w[0],S=w[1],_=(0,m.useState)(0),P=_[0],A=_[1],F=(0,m.useState)(0),I=F[0],K=F[1],T=(0,m.useState)(),D=T[0],O=T[1],U=(0,m.useState)(null),B=U[0],Q=U[1],z=(0,m.useState)(new Date),E=z[0],H=z[1],Z=(0,m.useState)([]),M=Z[0],V=Z[1],W={headers:{Authorization:"Bearer ".concat(e.token)}},X=function(){var t=N(r().mark((function t(e){var n,a,o,c,s,d,m,h,f,x,j;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),i.Am.loading("Submitting",{position:"bottom-right",theme:"dark"}),l(!0),n=p()(".productId").map((function(t,e){return p()(e).val()})).get(),a=p()(".productQuantity").map((function(t,e){return p()(e).val()})).get(),o=p()(".productPrice").map((function(t,e){return p()(e).val()})).get(),c=p()(".note").val(),s=p()(".date").val(),d=p()(".cash").val(),m=p()(".bcash").val(),h=p()(".nagad").val(),f=p()(".card").val(),x=p()(".customer-id").val(),!(n.length<=0)){t.next=18;break}return l(!1),i.Am.dismiss(),i.Am.error("No product added",{position:"bottom-right",autoClose:!1,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"dark"}),t.abrupt("return");case 18:return t.prev=18,t.next=21,u().post("".concat("http://pos-backend.webxcode.xyz/api","/invoice/store"),{customer_id:x,productIds:n,productQuantities:a,productPrices:o,date:s,comment:c,cash:d,bcash:m,nagad:h,card:f,discountAmount:I},W);case 21:!0===(j=t.sent).data.status?(i.Am.dismiss(),i.Am.success("Successfully Saved",{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"dark"}),p()("form").trigger("reset"),A(0),S(0),v(0),K(0),V([]),k(0),l(!1)):(i.Am.dismiss(),i.Am.success(j.data.error,{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"dark"}),l(!1)),t.next=30;break;case 25:t.prev=25,t.t0=t.catch(18),i.Am.dismiss(),i.Am.error(t.t0.response.data,{position:"bottom-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"dark"}),l(!1);case 30:case"end":return t.stop()}}),t,null,[[18,25]])})));return function(e){return t.apply(this,arguments)}}(),L=function(t){var e=parseFloat(p()(".productPrice_".concat(t)).val()),n=parseFloat(p()(".productQuantity_".concat(t)).val());p()(".subtotal_".concat(t)).text(e*n),$()},$=function(){v(0),k(0),S(0),p()(".subtotal").each((function(){var t=this;v((function(e){return e+parseFloat(p()(t).text())})),k((function(e){return e+parseFloat(p()(t).text())})),S((function(e){return e+parseFloat(p()(t).text())}))}))},q=function(){A(0),p()(".paid").each((function(){var t=this;A((function(e){return e+parseFloat(p()(t).val()?p()(t).val():0)}))}))},G=function(){var t=N(r().mark((function t(){var e;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p()(".autocompleteItemContainer.product").show(),B&&(clearTimeout(B),Q(null)),e=p()(".search-product").val(),Q(setTimeout((function(){u().get("".concat("http://pos-backend.webxcode.xyz/api","/product?name=").concat(e),W).then((function(t){!0===t.data.status&&O(t.data.products.data)})).catch((function(t){console.log(t)}))}),500));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),J=function(){var t=N(r().mark((function t(e){var n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),""!==(n=p()(".scan-barcode").val())&&u().get("".concat("http://pos-backend.webxcode.xyz/api","/product-by-barcode?id=").concat(n),W).then((function(t){!0===t.data.status?(R(t.data.product),p()(".scan-barcode").val(""),L(t.data.product.id)):alert("No product found")})).catch((function(t){console.log(t)}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),R=function(t){if(M.filter((function(e){return e.id===t.id})).length>0){var e=p()(".productQuantity_".concat(t.id)).val(),n=parseFloat(e)+1;p()(".productQuantity_".concat(t.id)).val(n)}else V((function(e){return y(e).concat([t])})),v((function(e){return e+parseFloat(t.price)})),k((function(e){return e+parseFloat(t.price)})),S((function(e){return e+parseFloat(t.price)}));p()(".autocompleteItemContainer.product").hide(),p()(".search-product").val("")},Y=function(t){p()(".cash").val(t),q()},tt=function(){var t=p()(".discount").val(),e=p()(".discount-type").val();if(k(0),S(0),p()(".subtotal").each((function(){var t=this;k((function(e){return e+parseFloat(p()(t).text())})),S((function(e){return e+parseFloat(p()(t).text())}))})),"%"===e){var n=g*parseFloat(t)/100;K(n)}else K(parseFloat(t))};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.default,{children:(0,o.jsx)("title",{children:"POS"})}),a&&!0===a&&(0,o.jsx)(j.Z,{}),(0,o.jsx)(i.Ix,{}),(0,o.jsx)(c.Z,{user:e,title:"POS",sidebar:"pos",topbar:"pos",children:(0,o.jsxs)("div",{className:"content-pos",children:[(0,o.jsx)("form",{onSubmit:X,id:"invoice"}),(0,o.jsx)("div",{className:"custom-card mb-3",children:(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("div",{className:"col-md-3",children:(0,o.jsx)(x.Z,{type:"customer",token:e.token,placeholder:"Search customer"})}),(0,o.jsx)("div",{className:"col-md-3",children:(0,o.jsx)(f(),{selected:E,onChange:function(t){return H(t)},dateFormat:"yyyy-MM-dd",className:"form-control date"})}),(0,o.jsx)("div",{className:"col-md-3",children:(0,o.jsx)("form",{onSubmit:J,children:(0,o.jsx)("input",{type:"text",className:"form-control scan-barcode",placeholder:"Scan Barcode Here",id:"barcode",autoFocus:!0})})}),(0,o.jsx)("div",{className:"col-md-3",children:(0,o.jsxs)("div",{className:"autocompleteWrapper product",children:[(0,o.jsx)("input",{type:"text",className:"form-control autocompleteInput search-product",autoComplete:"off",onKeyUp:G,onKeyDown:G,onChange:G,placeholder:"Search product"}),(0,o.jsx)("div",{className:"autocompleteItemContainer product",children:D&&D.map((function(t){return(0,o.jsx)("div",{className:"autocompleteItem",onClick:function(){return R(t)},children:t.name},"search-product-item-".concat(t.id))}))})]})})]})}),(0,o.jsx)("div",{className:"custom-card",children:(0,o.jsxs)("table",{className:"table table-bordered table-hover",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{width:"5%",children:"SL"}),(0,o.jsx)("th",{width:"35%",children:"Product Name"}),(0,o.jsx)("th",{width:"15%",children:"Price"}),(0,o.jsx)("th",{width:"15%",children:"Quantity"}),(0,o.jsx)("th",{className:"text-end",width:"20%",children:"Subtotal"}),(0,o.jsx)("th",{className:"text-center",width:"10%",children:"Action"})]})}),(0,o.jsxs)("tbody",{className:"border-bottom border-1 border-white",children:[M&&M.length<=0&&(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:6,className:"text-center",children:"No product added"})}),M.map((function(t,e){return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:e+1}),(0,o.jsxs)("td",{children:[t.name,(0,o.jsx)("input",{type:"hidden",className:"productId",defaultValue:t.id})]}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"text",className:"form-control productPrice productPrice_".concat(t.id),defaultValue:t.price,onChange:function(){return L(t.id)},onKeyUp:function(){return L(t.id)},onKeyDown:function(){return L(t.id)}})}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"text",className:"form-control productQuantity productQuantity_".concat(t.id),defaultValue:1,onChange:function(){return L(t.id)},onKeyUp:function(){return L(t.id)},onKeyDown:function(){return L(t.id)}})}),(0,o.jsxs)("td",{className:"text-end",children:[(0,o.jsx)("span",{className:"subtotal subtotal_".concat(t.id),children:t.price})," Tk."]}),(0,o.jsx)("td",{className:"text-center",children:(0,o.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){return function(t){var e=M.filter((function(e){return e.id!==t}));V(e),k(0),S(0),v(0),e.map((function(t){k((function(e){return e+parseFloat(p()(".subtotal_".concat(t.id)).text())})),S((function(e){return e+parseFloat(p()(".subtotal_".concat(t.id)).text())}))}))}(t.id)},children:(0,o.jsx)("i",{className:"fa-solid fa-trash-can"})})})]},"purchase-product-item-".concat(t.id))}))]}),(0,o.jsxs)("tfoot",{children:[(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"text-end",colSpan:4,children:(0,o.jsx)("strong",{children:"Subtotal"})}),(0,o.jsx)("td",{className:"text-end d-block",children:(0,o.jsxs)("span",{children:[h," Tk."]})}),(0,o.jsx)("td",{})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"text-end",colSpan:4,children:(0,o.jsx)("strong",{children:"Sale Discount"})}),(0,o.jsx)("td",{className:"text-end d-block",children:(0,o.jsx)("input",{type:"text",className:"form-control discount",onKeyUp:tt,onKeyDown:tt,onChange:tt})}),(0,o.jsx)("td",{children:(0,o.jsxs)("select",{className:"form-select form-control discount-type",onChange:tt,children:[(0,o.jsx)("option",{value:"%",children:"Percent"}),(0,o.jsx)("option",{value:"fixed",children:"Fixed"})]})})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"text-end",colSpan:4,children:(0,o.jsx)("strong",{children:"Discount Amount"})}),(0,o.jsxs)("td",{className:"text-end d-block",children:[(0,o.jsx)("span",{children:I})," Tk."]}),(0,o.jsx)("td",{})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"text-end",colSpan:4,children:(0,o.jsx)("strong",{children:"Total"})}),(0,o.jsxs)("td",{className:"text-end d-block",children:[(0,o.jsx)("span",{className:"total",children:g-I})," Tk."]}),(0,o.jsx)("td",{})]})]})]})}),(0,o.jsx)("div",{className:"mb-3 mt-3",children:(0,o.jsx)("textarea",{id:"note",rows:"3",className:"note form-control",placeholder:"Note"})}),(0,o.jsx)("button",{className:"btn btn-success mb-5",onClick:function(){p()(".payment-modal").fadeIn()},children:"Payment"})]})}),(0,o.jsx)("div",{className:"payment-modal",children:(0,o.jsxs)("div",{className:"payment-modal-container",children:[(0,o.jsx)("div",{className:"close",children:(0,o.jsx)("span",{className:"fa-solid fa-close",onClick:function(){p()(".payment-modal").fadeOut()}})}),(0,o.jsx)("div",{className:"title",children:"Payment"}),(0,o.jsx)("hr",{}),(0,o.jsxs)("div",{className:"row gx-5",children:[(0,o.jsxs)("div",{className:"col-md-8",children:[(0,o.jsxs)("div",{className:"form-group mb-3",children:[(0,o.jsx)("label",{className:"form-label",children:"Cash"}),(0,o.jsx)("input",{type:"text",className:"form-control paid cash",onKeyUp:q,onKeyDown:q,onChange:q})]}),(0,o.jsxs)("div",{className:"form-group mb-3",children:[(0,o.jsx)("label",{className:"form-label",children:"Bkash"}),(0,o.jsx)("input",{type:"text",className:"form-control paid bkash",onKeyUp:q,onKeyDown:q,onChange:q})]}),(0,o.jsxs)("div",{className:"form-group mb-3",children:[(0,o.jsx)("label",{className:"form-label",children:"Nagad"}),(0,o.jsx)("input",{type:"text",className:"form-control paid nagad",onKeyUp:q,onKeyDown:q,onChange:q})]}),(0,o.jsxs)("div",{className:"form-group mb-3",children:[(0,o.jsx)("label",{className:"form-label",children:"Card"}),(0,o.jsx)("input",{type:"text",className:"form-control paid card",onKeyUp:q,onKeyDown:q,onChange:q})]})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("div",{className:"notes",children:"Notes"}),(0,o.jsxs)("ul",{className:"note-list",children:[(0,o.jsx)("li",{onClick:function(){return Y(50)},children:"50"}),(0,o.jsx)("li",{onClick:function(){return Y(100)},children:"100"}),(0,o.jsx)("li",{onClick:function(){return Y(200)},children:"200"}),(0,o.jsx)("li",{onClick:function(){return Y(500)},children:"500"}),(0,o.jsx)("li",{onClick:function(){return Y(1e3)},children:"1000"})]})]})]}),(0,o.jsx)("hr",{}),(0,o.jsxs)("div",{className:"row",children:[(0,o.jsxs)("div",{className:"col-md-6",children:["Total : ",C-I," Tk."]}),(0,o.jsxs)("div",{className:"col-md-6",children:["Change/Due : ",C-P," Tk."]})]}),(0,o.jsx)("button",{className:"btn btn-success mt-3 float-end",onClick:X,children:"Save"})]})})]})}}},function(t){t.O(0,[571,619,669,782,198,688,774,888,179],(function(){return e=2020,t(t.s=e);var e}));var e=t.O();_N_E=e}]);
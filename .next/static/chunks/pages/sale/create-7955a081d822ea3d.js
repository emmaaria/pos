(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[653],{2020:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sale/create",function(){return n(7094)}])},8194:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var a=n(4051),r=n.n(a),o=n(5893),c=n(9669),s=n.n(c),i=n(9755),l=n.n(i),u=n(7294);function d(e,t,n,a,r,o,c){try{var s=e[o](c),i=s.value}catch(l){return void n(l)}s.done?t(i):Promise.resolve(i).then(a,r)}function p(e){var t=e.type,n=e.token,a=e.placeholder,c={headers:{Authorization:"Bearer ".concat(n)}},i=(0,u.useState)(null),p=i[0],m=i[1],h=(0,u.useState)(),f=h[0],x=h[1],j=function(){var e,n=(e=r().mark((function e(){var n,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l()(".autocompleteItemContainer.supplier").show(),p&&(clearTimeout(p),m(null)),"supplier"===t&&(n=l()(".autocompleteInput").val(),m(setTimeout((function(){s().get("".concat("//pos-backend.webxcode.xyz/api","/supplier?name=").concat(n),c).then((function(e){!0===e.data.status&&x(e.data.suppliers.data)})).catch((function(e){console.log(e)}))}),1e3))),"customer"===t&&(a=l()(".autocompleteInput").val(),m(setTimeout((function(){s().get("".concat("//pos-backend.webxcode.xyz/api","/customer?name=").concat(a),c).then((function(e){!0===e.data.status&&x(e.data.customers.data)})).catch((function(e){console.log(e)}))}),1e3)));case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){d(o,a,r,c,s,"next",e)}function s(e){d(o,a,r,c,s,"throw",e)}c(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"autocompleteWrapper",children:[(0,o.jsx)("input",{type:"text",className:"form-control autocompleteInput supplier-input",autoComplete:"off",onKeyUp:j,onKeyDown:j,onChange:j,placeholder:a||""}),t&&"supplier"===t&&(0,o.jsx)("input",{type:"hidden",className:"supplier-id"}),t&&"customer"===t&&(0,o.jsx)("input",{type:"hidden",className:"customer-id"}),(0,o.jsx)("div",{className:"autocompleteItemContainer supplier",children:f&&f.map((function(e){return(0,o.jsx)("div",{className:"autocompleteItem",onClick:function(){return n=e.name,a=e.id,l()(".supplier-input").val(n),"supplier"===t&&l()(".supplier-id").val(a),"customer"===t&&l()(".customer-id").val(a),void l()(".autocompleteItemContainer.supplier").hide();var n,a},children:e.name},"supplier-".concat(e.id))}))})]})})}},9270:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(5893);function r(){return(0,a.jsx)("div",{className:"loader"})}},7094:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return g},default:function(){return k}});var a=n(4051),r=n.n(a),o=n(5893),c=n(5688),s=n(9008),i=n(5538),l=n(9669),u=n.n(l),d=n(9755),p=n.n(d),m=n(7294),h=n(9198),f=n.n(h),x=n(8194),j=n(9270);function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function b(e,t,n,a,r,o,c){try{var s=e[o](c),i=s.value}catch(l){return void n(l)}s.done?t(i):Promise.resolve(i).then(a,r)}function N(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){b(o,a,r,c,s,"next",e)}function s(e){b(o,a,r,c,s,"throw",e)}c(void 0)}))}}function y(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var g=!0;function k(e){var t=e.user,n=(0,m.useState)(!1),a=n[0],l=n[1],d=(0,m.useState)(0),h=d[0],v=d[1],b=(0,m.useState)(0),g=b[0],k=b[1],w=(0,m.useState)(0),C=w[0],S=w[1],_=(0,m.useState)(0),P=_[0],A=_[1],F=(0,m.useState)(0),I=F[0],K=F[1],T=(0,m.useState)(),D=T[0],O=T[1],U=(0,m.useState)(null),B=U[0],Q=U[1],z=(0,m.useState)(new Date),E=z[0],H=z[1],Z=(0,m.useState)([]),M=Z[0],V=Z[1],W={headers:{Authorization:"Bearer ".concat(t.token)}},X=function(){var e=N(r().mark((function e(t){var n,a,o,c,s,d,m,h,f,x,j;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),i.Am.loading("Submitting",{position:"bottom-right",theme:"dark"}),l(!0),n=p()(".productId").map((function(e,t){return p()(t).val()})).get(),a=p()(".productQuantity").map((function(e,t){return p()(t).val()})).get(),o=p()(".productPrice").map((function(e,t){return p()(t).val()})).get(),c=p()(".note").val(),s=p()(".date").val(),d=p()(".cash").val(),m=p()(".bcash").val(),h=p()(".nagad").val(),f=p()(".card").val(),x=p()(".customer-id").val(),!(n.length<=0)){e.next=18;break}return l(!1),i.Am.dismiss(),i.Am.error("No product added",{position:"bottom-right",autoClose:!1,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"dark"}),e.abrupt("return");case 18:return e.prev=18,e.next=21,u().post("".concat("//pos-backend.webxcode.xyz/api","/invoice/store"),{customer_id:x,productIds:n,productQuantities:a,productPrices:o,date:s,comment:c,cash:d,bcash:m,nagad:h,card:f,discountAmount:I},W);case 21:!0===(j=e.sent).data.status?(i.Am.dismiss(),i.Am.success("Successfully Saved",{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"dark"}),p()("form").trigger("reset"),A(0),S(0),v(0),K(0),V([]),k(0),l(!1)):(i.Am.dismiss(),i.Am.success(j.data.error,{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"dark"}),l(!1)),e.next=30;break;case 25:e.prev=25,e.t0=e.catch(18),i.Am.dismiss(),i.Am.error(e.t0.response.data,{position:"bottom-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,theme:"dark"}),l(!1);case 30:case"end":return e.stop()}}),e,null,[[18,25]])})));return function(t){return e.apply(this,arguments)}}(),L=function(e){var t=parseFloat(p()(".productPrice_".concat(e)).val()),n=parseFloat(p()(".productQuantity_".concat(e)).val());p()(".subtotal_".concat(e)).text(t*n),$()},$=function(){v(0),k(0),S(0),p()(".subtotal").each((function(){var e=this;v((function(t){return t+parseFloat(p()(e).text())})),k((function(t){return t+parseFloat(p()(e).text())})),S((function(t){return t+parseFloat(p()(e).text())}))}))},q=function(){A(0),p()(".paid").each((function(){var e=this;A((function(t){return t+parseFloat(p()(e).val()?p()(e).val():0)}))}))},G=function(){var e=N(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p()(".autocompleteItemContainer.product").show(),B&&(clearTimeout(B),Q(null)),t=p()(".search-product").val(),Q(setTimeout((function(){u().get("".concat("//pos-backend.webxcode.xyz/api","/product?name=").concat(t),W).then((function(e){!0===e.data.status&&O(e.data.products.data)})).catch((function(e){console.log(e)}))}),500));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=N(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),""!==(n=p()(".scan-barcode").val())&&u().get("".concat("//pos-backend.webxcode.xyz/api","/product-by-barcode?id=").concat(n),W).then((function(e){!0===e.data.status?(R(e.data.product),p()(".scan-barcode").val(""),L(e.data.product.id)):alert("No product found")})).catch((function(e){console.log(e)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(e){if(M.filter((function(t){return t.id===e.id})).length>0){var t=p()(".productQuantity_".concat(e.id)).val(),n=parseFloat(t)+1;p()(".productQuantity_".concat(e.id)).val(n)}else V((function(t){return y(t).concat([e])})),v((function(t){return t+parseFloat(e.price)})),k((function(t){return t+parseFloat(e.price)})),S((function(t){return t+parseFloat(e.price)}));p()(".autocompleteItemContainer.product").hide(),p()(".search-product").val("")},Y=function(e){p()(".cash").val(e),q()},ee=function(){var e=p()(".discount").val(),t=p()(".discount-type").val();if(k(0),S(0),p()(".subtotal").each((function(){var e=this;k((function(t){return t+parseFloat(p()(e).text())})),S((function(t){return t+parseFloat(p()(e).text())}))})),"%"===t){var n=g*parseFloat(e)/100;K(n)}else K(parseFloat(e))};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.default,{children:(0,o.jsx)("title",{children:"POS"})}),a&&!0===a&&(0,o.jsx)(j.Z,{}),(0,o.jsx)(i.Ix,{}),(0,o.jsx)(c.Z,{user:t,title:"POS",sidebar:"pos",topbar:"pos",children:(0,o.jsxs)("div",{className:"content-pos",children:[(0,o.jsx)("form",{onSubmit:X,id:"invoice"}),(0,o.jsx)("div",{className:"custom-card mb-3",children:(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("div",{className:"col-md-3",children:(0,o.jsx)(x.Z,{type:"customer",token:t.token,placeholder:"Search customer"})}),(0,o.jsx)("div",{className:"col-md-3",children:(0,o.jsx)(f(),{selected:E,onChange:function(e){return H(e)},dateFormat:"yyyy-MM-dd",className:"form-control date"})}),(0,o.jsx)("div",{className:"col-md-3",children:(0,o.jsx)("form",{onSubmit:J,children:(0,o.jsx)("input",{type:"text",className:"form-control scan-barcode",placeholder:"Scan Barcode Here",id:"barcode",autoFocus:!0})})}),(0,o.jsx)("div",{className:"col-md-3",children:(0,o.jsxs)("div",{className:"autocompleteWrapper product",children:[(0,o.jsx)("input",{type:"text",className:"form-control autocompleteInput search-product",autoComplete:"off",onKeyUp:G,onKeyDown:G,onChange:G,placeholder:"Search product"}),(0,o.jsx)("div",{className:"autocompleteItemContainer product",children:D&&D.map((function(e){return(0,o.jsx)("div",{className:"autocompleteItem",onClick:function(){return R(e)},children:e.name},"search-product-item-".concat(e.id))}))})]})})]})}),(0,o.jsx)("div",{className:"custom-card",children:(0,o.jsxs)("table",{className:"table table-bordered table-hover",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{width:"5%",children:"SL"}),(0,o.jsx)("th",{width:"35%",children:"Product Name"}),(0,o.jsx)("th",{width:"15%",children:"Price"}),(0,o.jsx)("th",{width:"15%",children:"Quantity"}),(0,o.jsx)("th",{className:"text-end",width:"20%",children:"Subtotal"}),(0,o.jsx)("th",{className:"text-center",width:"10%",children:"Action"})]})}),(0,o.jsxs)("tbody",{className:"border-bottom border-1 border-white",children:[M&&M.length<=0&&(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:6,className:"text-center",children:"No product added"})}),M.map((function(e,t){return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:t+1}),(0,o.jsxs)("td",{children:[e.name,(0,o.jsx)("input",{type:"hidden",className:"productId",defaultValue:e.id})]}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"text",className:"form-control productPrice productPrice_".concat(e.id),defaultValue:e.price,onChange:function(){return L(e.id)},onKeyUp:function(){return L(e.id)},onKeyDown:function(){return L(e.id)}})}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"text",className:"form-control productQuantity productQuantity_".concat(e.id),defaultValue:1,onChange:function(){return L(e.id)},onKeyUp:function(){return L(e.id)},onKeyDown:function(){return L(e.id)}})}),(0,o.jsxs)("td",{className:"text-end",children:[(0,o.jsx)("span",{className:"subtotal subtotal_".concat(e.id),children:e.price})," Tk."]}),(0,o.jsx)("td",{className:"text-center",children:(0,o.jsx)("button",{className:"btn btn-danger btn-sm",onClick:function(){return function(e){var t=M.filter((function(t){return t.id!==e}));V(t),k(0),S(0),v(0),t.map((function(e){k((function(t){return t+parseFloat(p()(".subtotal_".concat(e.id)).text())})),S((function(t){return t+parseFloat(p()(".subtotal_".concat(e.id)).text())}))}))}(e.id)},children:(0,o.jsx)("i",{className:"fa-solid fa-trash-can"})})})]},"purchase-product-item-".concat(e.id))}))]}),(0,o.jsxs)("tfoot",{children:[(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"text-end",colSpan:4,children:(0,o.jsx)("strong",{children:"Subtotal"})}),(0,o.jsx)("td",{className:"text-end d-block",children:(0,o.jsxs)("span",{children:[h," Tk."]})}),(0,o.jsx)("td",{})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"text-end",colSpan:4,children:(0,o.jsx)("strong",{children:"Sale Discount"})}),(0,o.jsx)("td",{className:"text-end d-block",children:(0,o.jsx)("input",{type:"text",className:"form-control discount",onKeyUp:ee,onKeyDown:ee,onChange:ee})}),(0,o.jsx)("td",{children:(0,o.jsxs)("select",{className:"form-select form-control discount-type",onChange:ee,children:[(0,o.jsx)("option",{value:"%",children:"Percent"}),(0,o.jsx)("option",{value:"fixed",children:"Fixed"})]})})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"text-end",colSpan:4,children:(0,o.jsx)("strong",{children:"Discount Amount"})}),(0,o.jsxs)("td",{className:"text-end d-block",children:[(0,o.jsx)("span",{children:I})," Tk."]}),(0,o.jsx)("td",{})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"text-end",colSpan:4,children:(0,o.jsx)("strong",{children:"Total"})}),(0,o.jsxs)("td",{className:"text-end d-block",children:[(0,o.jsx)("span",{className:"total",children:g-I})," Tk."]}),(0,o.jsx)("td",{})]})]})]})}),(0,o.jsx)("div",{className:"mb-3 mt-3",children:(0,o.jsx)("textarea",{id:"note",rows:"3",className:"note form-control",placeholder:"Note"})}),(0,o.jsx)("button",{className:"btn btn-success mb-5",onClick:function(){p()(".payment-modal").fadeIn()},children:"Payment"})]})}),(0,o.jsx)("div",{className:"payment-modal",children:(0,o.jsxs)("div",{className:"payment-modal-container",children:[(0,o.jsx)("div",{className:"close",children:(0,o.jsx)("span",{className:"fa-solid fa-close",onClick:function(){p()(".payment-modal").fadeOut()}})}),(0,o.jsx)("div",{className:"title",children:"Payment"}),(0,o.jsx)("hr",{}),(0,o.jsxs)("div",{className:"row gx-5",children:[(0,o.jsxs)("div",{className:"col-md-8",children:[(0,o.jsxs)("div",{className:"form-group mb-3",children:[(0,o.jsx)("label",{className:"form-label",children:"Cash"}),(0,o.jsx)("input",{type:"text",className:"form-control paid cash",onKeyUp:q,onKeyDown:q,onChange:q})]}),(0,o.jsxs)("div",{className:"form-group mb-3",children:[(0,o.jsx)("label",{className:"form-label",children:"Bkash"}),(0,o.jsx)("input",{type:"text",className:"form-control paid bkash",onKeyUp:q,onKeyDown:q,onChange:q})]}),(0,o.jsxs)("div",{className:"form-group mb-3",children:[(0,o.jsx)("label",{className:"form-label",children:"Nagad"}),(0,o.jsx)("input",{type:"text",className:"form-control paid nagad",onKeyUp:q,onKeyDown:q,onChange:q})]}),(0,o.jsxs)("div",{className:"form-group mb-3",children:[(0,o.jsx)("label",{className:"form-label",children:"Card"}),(0,o.jsx)("input",{type:"text",className:"form-control paid card",onKeyUp:q,onKeyDown:q,onChange:q})]})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("div",{className:"notes",children:"Notes"}),(0,o.jsxs)("ul",{className:"note-list",children:[(0,o.jsx)("li",{onClick:function(){return Y(50)},children:"50"}),(0,o.jsx)("li",{onClick:function(){return Y(100)},children:"100"}),(0,o.jsx)("li",{onClick:function(){return Y(200)},children:"200"}),(0,o.jsx)("li",{onClick:function(){return Y(500)},children:"500"}),(0,o.jsx)("li",{onClick:function(){return Y(1e3)},children:"1000"})]})]})]}),(0,o.jsx)("hr",{}),(0,o.jsxs)("div",{className:"row",children:[(0,o.jsxs)("div",{className:"col-md-6",children:["Total : ",C-I," Tk."]}),(0,o.jsxs)("div",{className:"col-md-6",children:["Change/Due : ",C-P," Tk."]})]}),(0,o.jsx)("button",{className:"btn btn-success mt-3 float-end",onClick:X,children:"Save"})]})})]})}}},function(e){e.O(0,[571,619,669,782,198,688,774,888,179],(function(){return t=2020,e(e.s=t);var t}));var t=e.O();_N_E=t}]);